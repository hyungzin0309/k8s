## Multi Scheduler

> Kubernetes 스케줄러는 다양한 유형의 워크로드와 요구 사항을 효율적으로 처리할 수 있도록 설계되어 있다. 그러나 모든 시나리오를 커버할 수 있는 완벽한 솔루션은 없기 때문에, 특정 상황에서 사용자 정의 스케줄링 로직이나 정책을 적용할 필요가 있을 수 있다.


### 사용 사례
1. **특수한 스케줄링 요구 사항**
<br>특정 애플리케이션이나 워크로드에 맞춤형 스케줄링 로직이 필요한 경우, 사용자 정의 스케줄러를 통해 이러한 요구 사항을 충족시킬 수 있다. 예를 들어, GPU와 같은 특수한 리소스가 필요한 애플리케이션 또는 매우 높은 우선순위의 임무-크리티컬한 작업을 위한 스케줄링 정책이 이에 해당된다.


2. **테스트 및 평가**
<br>새로운 스케줄링 알고리즘을 테스트하거나 기존 알고리즘과 비교하고자 할 때, 여러 스케줄러를 병행하여 실행함으로써 실제 클러스터 환경에서의 성능과 효율성을 평가할 수 있다.


3. **가용성 향상**
<br>여러 스케줄러를 사용하면, 하나의 스케줄러에 문제가 발생했을 때 다른 스케줄러가 작업을 계속 진행할 수 있어 시스템의 전반적인 가용성이 향상될 수 있다.


### 멀티 스케줄러 사용 시 고려 사항
1. **관리 복잡성**
<br>여러 스케줄러를 사용하면 클러스터 관리의 복잡성이 증가할 수 있다. 각 스케줄러의 구성, 업데이트 및 유지 관리가 필요하다.


2. **충돌**
<br>서로 다른 스케줄러가 동일한 리소스에 대해 충돌할 수 있으므로, 이를 방지하기 위한 명확한 정책과 조정 메커니즘이 필요하다.


3. **스케줄링 일관성**
<br>여러 스케줄러 간의 정책이 충돌하지 않도록 하고, 전체 클러스터의 스케줄링 정책이 일관되게 유지되어야 한다.

---

## 적용 방법

1. **사용자 정의 스케줄러 구현**
   <br>사용자 정의 스케줄러를 구현한다. 이는 Kubernetes의 스케줄링 프레임워크를 사용하여 개발할 수 있으며, 특정 스케줄링 로직이나 요구 사항에 맞게 커스터마이징할 수 있다.
   사용자 정의 스케줄러에는 고유한 이름이 있어야 한다. 이 이름은 파드 스케줄링 시 해당 스케줄러를 지정하는 데 사용된다.


2. **사용자 정의 스케줄러 배포**
   <br>사용자 정의 스케줄러를 컨테이너 이미지로 빌드하고, Kubernetes 클러스터에 배포한다. 배포는 일반적으로 Deployment 리소스를 사용하여 수행된다.
   사용자 정의 스케줄러는 적절한 권한을 가진 ServiceAccount 를 사용해야 한다. 이를 위해 RBAC(Role-Based Access Control) 정책을 구성하여 스케줄러가 클러스터 리소스에 접근할 수 있도록 한다.


3. **파드 스케줄링을 위한 스케줄러 지정**
   <br>특정 파드가 사용자 정의 스케줄러에 의해 스케줄링되도록 하려면, 아래 예시 yaml 과 같이 파드 정의에서 schedulerName 필드를 사용하여 스케줄러를 명시적으로 지정해야 한다.

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: my-custom-pod
spec:
  containers:
  - name: my-container
    image: my-image
  schedulerName: my-custom-scheduler
```

